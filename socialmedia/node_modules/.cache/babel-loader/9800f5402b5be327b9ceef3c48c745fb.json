{"ast":null,"code":"\"use strict\";\n/**\r\n * Created by hustcc on 18/5/20.\r\n * Contract: i@hust.cc\r\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\n/**\r\n * format Date / string / timestamp to Date instance.\r\n * @param input\r\n * @returns {*}\r\n */\n\nfunction toDate(input) {\n  if (input instanceof Date) return +input; // @ts-ignore\n\n  if (!isNaN(input) || /^\\d+$/.test(input)) return +new Date(parseInt(input));\n  input = (input || '').trim().replace(/\\.\\d+/, '') // remove milliseconds\n  .replace(/-/, '/').replace(/-/, '/').replace(/(\\d)T(\\d)/, '$1 $2').replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\n  .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\n\n  return +new Date(input);\n}\n\nexports.toDate = toDate;\n/**\r\n * format the diff second to *** time ago, with setting locale\r\n * @param diff\r\n * @param localeFunc\r\n * @returns\r\n */\n\nfunction formatDiff(diff, localeFunc) {\n  // if locale is not exist, use defaultLocale.\n  // if defaultLocale is not exist, use build-in `en`.\n  // be sure of no error when locale is not exist.\n  var agoIn = diff < 0 ? 1 : 0; // time in or time ago\n\n  diff = Math.abs(diff);\n  var totalSec = diff;\n  var idx = 0;\n\n  for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\n    diff /= SEC_ARRAY[idx];\n  }\n\n  diff = ~~diff;\n  idx *= 2;\n  if (diff > (idx === 0 ? 9 : 1)) idx += 1; // @ts-ignore\n\n  return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff);\n}\n\nexports.formatDiff = formatDiff;\n/**\r\n * calculate the diff second between date to be formatted an now date.\r\n * @param date\r\n * @param relativeDate\r\n * @returns\r\n */\n\nfunction diffSec(date, relativeDate) {\n  relativeDate = relativeDate ? toDate(relativeDate) : +new Date();\n  return (relativeDate - toDate(date)) / 1000;\n}\n\nexports.diffSec = diffSec;\n/**\r\n * nextInterval: calculate the next interval time.\r\n * - diff: the diff sec between now and date to be formatted.\r\n *\r\n * What's the meaning?\r\n * diff = 61 then return 59\r\n * diff = 3601 (an hour + 1 second), then return 3599\r\n * make the interval with high performance.\r\n **/\n\nfunction nextInterval(diff) {\n  var rst = 1,\n      i = 0,\n      d = Math.abs(diff);\n\n  for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\n    diff /= SEC_ARRAY[i];\n    rst *= SEC_ARRAY[i];\n  }\n\n  d = d % rst;\n  d = d ? rst - d : rst; // Math.ceil\n\n  return ~~d;\n}\n\nexports.nextInterval = nextInterval;","map":{"version":3,"sources":["utils/date.ts"],"names":[],"mappings":";AAAA;;;AAGG;;;;;AAIH,IAAM,SAAS,GAAG,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,CAAb,EAAgB,MAAM,CAAN,GAAU,EAA1B,EAA8B,EAA9B,CAAlB;AAEA;;;;AAIG;;AACH,SAAgB,MAAhB,CAAuB,KAAvB,EAAqD;AACnD,MAAI,KAAK,YAAY,IAArB,EAA2B,OAAO,CAAC,KAAR,CADwB,CAEnD;;AACA,MAAI,CAAC,KAAK,CAAC,KAAD,CAAN,IAAiB,QAAQ,IAAR,CAAa,KAAb,CAArB,EAA0C,OAAO,CAAC,IAAI,IAAJ,CAAS,QAAQ,CAAC,KAAD,CAAjB,CAAR;AAC1C,EAAA,KAAK,GAAG,CAAC,KAAK,IAAI,EAAV,EAEL,IAFK,GAGL,OAHK,CAGG,OAHH,EAGY,EAHZ,EAGgB;AAHhB,GAIL,OAJK,CAIG,GAJH,EAIQ,GAJR,EAKL,OALK,CAKG,GALH,EAKQ,GALR,EAML,OANK,CAMG,WANH,EAMgB,OANhB,EAOL,OAPK,CAOG,GAPH,EAOQ,MAPR,EAOgB;AAPhB,GAQL,OARK,CAQG,oBARH,EAQyB,OARzB,CAAR,CAJmD,CAYR;;AAC3C,SAAO,CAAC,IAAI,IAAJ,CAAS,KAAT,CAAR;AACD;;AAdD,OAAA,CAAA,MAAA,GAAA,MAAA;AAgBA;;;;;AAKG;;AACH,SAAgB,UAAhB,CAA2B,IAA3B,EAAyC,UAAzC,EAA+D;AAC7D;AACA;AACA;AACA,MAAM,KAAK,GAAG,IAAI,GAAG,CAAP,GAAW,CAAX,GAAe,CAA7B,CAJ6D,CAI7B;;AAEhC,EAAA,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAT,CAAP;AACA,MAAM,QAAQ,GAAG,IAAjB;AAEA,MAAI,GAAG,GAAG,CAAV;;AAEA,SAAO,IAAI,IAAI,SAAS,CAAC,GAAD,CAAjB,IAA0B,GAAG,GAAG,SAAS,CAAC,MAAjD,EAAyD,GAAG,EAA5D,EAAgE;AAC9D,IAAA,IAAI,IAAI,SAAS,CAAC,GAAD,CAAjB;AACD;;AACD,EAAA,IAAI,GAAG,CAAC,CAAC,IAAT;AACA,EAAA,GAAG,IAAI,CAAP;AAEA,MAAI,IAAI,IAAI,GAAG,KAAK,CAAR,GAAY,CAAZ,GAAgB,CAApB,CAAR,EAAgC,GAAG,IAAI,CAAP,CAjB6B,CAkB7D;;AACA,SAAO,UAAU,CAAC,IAAD,EAAO,GAAP,EAAY,QAAZ,CAAV,CAAgC,KAAhC,EAAuC,OAAvC,CAA+C,IAA/C,EAAqD,IAArD,CAAP;AACD;;AApBD,OAAA,CAAA,UAAA,GAAA,UAAA;AAsBA;;;;;AAKG;;AACH,SAAgB,OAAhB,CAAwB,IAAxB,EAAqC,YAArC,EAAiD;AAC/C,EAAA,YAAY,GAAG,YAAY,GAAG,MAAM,CAAC,YAAD,CAAT,GAA0B,CAAC,IAAI,IAAJ,EAAtD;AACA,SAAO,CAAC,YAAY,GAAG,MAAM,CAAC,IAAD,CAAtB,IAAgC,IAAvC;AACD;;AAHD,OAAA,CAAA,OAAA,GAAA,OAAA;AAKA;;;;;;;;AAQI;;AACJ,SAAgB,YAAhB,CAA6B,IAA7B,EAAyC;AACvC,MAAI,GAAG,GAAG,CAAV;AAAA,MACE,CAAC,GAAG,CADN;AAAA,MAEE,CAAC,GAAG,IAAI,CAAC,GAAL,CAAS,IAAT,CAFN;;AAGA,SAAO,IAAI,IAAI,SAAS,CAAC,CAAD,CAAjB,IAAwB,CAAC,GAAG,SAAS,CAAC,MAA7C,EAAqD,CAAC,EAAtD,EAA0D;AACxD,IAAA,IAAI,IAAI,SAAS,CAAC,CAAD,CAAjB;AACA,IAAA,GAAG,IAAI,SAAS,CAAC,CAAD,CAAhB;AACD;;AACD,EAAA,CAAC,GAAG,CAAC,GAAG,GAAR;AACA,EAAA,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAT,GAAa,GAAlB,CATuC,CAUvC;;AACA,SAAO,CAAC,CAAC,CAAT;AACD;;AAZD,OAAA,CAAA,YAAA,GAAA,YAAA","sourceRoot":"src/","sourcesContent":["\"use strict\";\r\n/**\r\n * Created by hustcc on 18/5/20.\r\n * Contract: i@hust.cc\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\r\n/**\r\n * format Date / string / timestamp to Date instance.\r\n * @param input\r\n * @returns {*}\r\n */\r\nfunction toDate(input) {\r\n    if (input instanceof Date)\r\n        return +input;\r\n    // @ts-ignore\r\n    if (!isNaN(input) || /^\\d+$/.test(input))\r\n        return +new Date(parseInt(input));\r\n    input = (input || '')\r\n        // @ts-ignore\r\n        .trim()\r\n        .replace(/\\.\\d+/, '') // remove milliseconds\r\n        .replace(/-/, '/')\r\n        .replace(/-/, '/')\r\n        .replace(/(\\d)T(\\d)/, '$1 $2')\r\n        .replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\r\n        .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\r\n    return +new Date(input);\r\n}\r\nexports.toDate = toDate;\r\n/**\r\n * format the diff second to *** time ago, with setting locale\r\n * @param diff\r\n * @param localeFunc\r\n * @returns\r\n */\r\nfunction formatDiff(diff, localeFunc) {\r\n    // if locale is not exist, use defaultLocale.\r\n    // if defaultLocale is not exist, use build-in `en`.\r\n    // be sure of no error when locale is not exist.\r\n    var agoIn = diff < 0 ? 1 : 0; // time in or time ago\r\n    diff = Math.abs(diff);\r\n    var totalSec = diff;\r\n    var idx = 0;\r\n    for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\r\n        diff /= SEC_ARRAY[idx];\r\n    }\r\n    diff = ~~diff;\r\n    idx *= 2;\r\n    if (diff > (idx === 0 ? 9 : 1))\r\n        idx += 1;\r\n    // @ts-ignore\r\n    return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff);\r\n}\r\nexports.formatDiff = formatDiff;\r\n/**\r\n * calculate the diff second between date to be formatted an now date.\r\n * @param date\r\n * @param relativeDate\r\n * @returns\r\n */\r\nfunction diffSec(date, relativeDate) {\r\n    relativeDate = relativeDate ? toDate(relativeDate) : +new Date();\r\n    return (relativeDate - toDate(date)) / 1000;\r\n}\r\nexports.diffSec = diffSec;\r\n/**\r\n * nextInterval: calculate the next interval time.\r\n * - diff: the diff sec between now and date to be formatted.\r\n *\r\n * What's the meaning?\r\n * diff = 61 then return 59\r\n * diff = 3601 (an hour + 1 second), then return 3599\r\n * make the interval with high performance.\r\n **/\r\nfunction nextInterval(diff) {\r\n    var rst = 1, i = 0, d = Math.abs(diff);\r\n    for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\r\n        diff /= SEC_ARRAY[i];\r\n        rst *= SEC_ARRAY[i];\r\n    }\r\n    d = d % rst;\r\n    d = d ? rst - d : rst;\r\n    // Math.ceil\r\n    return ~~d;\r\n}\r\nexports.nextInterval = nextInterval;\r\n//# sourceMappingURL=date.js.map"]},"metadata":{},"sourceType":"script"}